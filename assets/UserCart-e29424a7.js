import{m as I,a as L,_ as V,o as s,b as d,d as t,f as l,t as p,V as $,r as g,e as m,J as D,h as u,w as b,F as y,i as C,j as w,v as T,s as U,g as x,L as j,p as R,k as E}from"./index-7a856396.js";import{c as k}from"./UserCartStore-a8fb8089.js";import{M as F}from"./modal-42381a5f.js";import{U as O}from"./UserCartStepComponent-07c4cf2a.js";import"./component-functions-308a0234.js";import"./selector-engine-5dbcb248.js";import"./focustrap-0cef5967.js";const q={props:["product"],data(){return{modal:""}},methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()},...I(k,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","createOrder","getOrders","setModal"])},computed:{...L(k,["cartData","cartsLength"])},mounted(){this.setModal(new F(this.$refs.delmodal))}},J={id:"delProductModal",ref:"delmodal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},N={class:"modal-dialog modal-dialog-centered"},W={class:"modal-content border-0"},z={key:0,class:"modal-body"},G={class:"text-danger"},Z={key:1,class:"modal-body"},H=t("span",{class:"text-danger fw-bold"},"全部商品",-1),X={class:"modal-footer"},Q=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Y(e,n,c,A,h,i){var v,f;return s(),d("div",J,[t("div",N,[t("div",W,[c.product.id?(s(),d("div",z,[l(" 是否刪除 "),t("strong",G,p((f=(v=c.product)==null?void 0:v.product)==null?void 0:f.title),1),l(" 商品 ")])):(s(),d("div",Z,[l(" 是否刪除 "),H])),t("div",X,[Q,c.product.id?(s(),d("button",{key:0,type:"button",class:"btn btn-danger text-white",onClick:n[0]||(n[0]=_=>e.deleteItem(c.product.id))}," 確認刪除 ")):(s(),d("button",{key:1,type:"button",class:"btn btn-danger text-white",onClick:n[1]||(n[1]=(..._)=>e.deleteAllItem&&e.deleteAllItem(..._))}," 確認刪除 "))])])])],512)}const K=V(q,[["render",Y]]);const{VITE_APP_URL:M,VITE_APP_PATH:B}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"jiangs2023",BASE_URL:"/somesweet/",MODE:"production",DEV:!1,PROD:!0},tt={data(){return{products:[],tempProduct:{},tempCart:{},coupon_code:"",id:""}},components:{UserCartStepComponent:O,DelModal:K,VueLoading:$},methods:{getProducts(){this.$http.get(`${M}api/${B}/products/all`).then(e=>{console.log("產品列表:",e.data.products),this.products=e.data.products})},getProduct(e){this.$router.push(`/product/${e}`)},openDelProductModal(e){this.tempProduct={...e},console.log(this.tempProduct),this.modal.show()},openAllDelProductModal(e){this.tempProduct={},this.tempCart={...e},console.log(this.cartData),this.modal.show()},addCouponCode(){const e=`${M}api/${B}/coupon`,n={code:this.coupon_code};this.$http.post(e,{data:n}).then(c=>{console.log(c),this.coupon_code="",this.getCarts()})},...I(k,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","createOrder","getOrders","setModal","toThousands"])},computed:{...L(k,["cartData","cartsLength","modal","isLoading"])},mounted(){this.getProducts(),this.getCarts()}},r=e=>(R("data-v-d4416bfd"),e=e(),E(),e),et={key:1,class:"text-center"},ot={class:"card border-0 rounded-0 bg-dark text-white"},st=r(()=>t("img",{style:{height:"70vh","background-image":"url(https://storage.googleapis.com/vue-course-api.appspot.com/jiangs2023/1678158943058.jpg?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=Jn44%2B%2Bkd2gsFMtS91bnOaxSgmiZ1%2Byv%2B9wCGscJsTeCPU%2FnJc9ZMY5OM9AHec%2FYg0WQ%2BBMf2MqVBex%2Buondfr5cs8qgrLhRaqjzancMVsdSQh7%2Bt%2Bvve3ZpNoGtFIw29HggFVxqpBmJfWJU43sheDg966D5usj5PlkswQ7xutpIJwBZSAu4tuYZ%2BhVszThrE3rXRR9BRRfXvRxgiJpPlrlg3XxAbSE%2BvNgwq4iRl11eaE5fXuWGI8nRu4ORW%2FhG1SBtgGsYb0TAJ4jFPxNlDKjmI%2FBal2WrWD32jtOjvsSUbtxatHQ5OKx0vos6oW%2BIonUawlg6B%2FsNcChWBXVxDZw%3D%3D)","background-size":"cover","background-position":"center bottom","object-fit":"cover","background-attachment":"fixed","background-blend-mode":"multiply","background-color":"rgba(0, 0, 0, 0.6)"}},null,-1)),dt={class:"card-img-overlay d-flex flex-column justify-content-center align-item-center"},nt={class:"card-title text-center"},at=r(()=>t("br",null,null,-1)),lt={class:"d-flex align-items-center justify-content-center mt-5"},rt={type:"button",class:"btn btn-outline-secondary me-5"},ct={type:"button",class:"btn btn-light"},it={key:2,class:"container"},ut={class:"text-end mb-7"},pt=r(()=>t("i",{class:"bi bi-trash3 text-danger me-2"},null,-1)),ht={class:"table align-middle table-hover"},_t=r(()=>t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"100px"}},"數量"),t("th",{class:"text-end"},"單價"),t("th")])],-1)),mt={style:{width:"15%"}},gt=["onClick"],bt=["src"],vt=["onClick"],ft={class:"input-group input-group-sm"},yt=["onUpdate:modelValue","onChange"],kt=["value"],Ct=["value"],xt={class:"text-end"},Pt={class:"text-end"},Dt=["onClick"],wt=r(()=>t("i",{class:"bi bi-trash3 text-danger"},null,-1)),Mt=[wt],Bt=r(()=>t("td",{colspan:"3",class:"text-end"},"總計",-1)),It={class:"text-end"},Lt=r(()=>t("td",null,null,-1)),Vt=r(()=>t("td",{colspan:"3",class:"text-end text-success"},"折扣完總金額",-1)),At={class:"text-end text-success"},St=r(()=>t("td",null,null,-1)),$t={class:"row justify-content-end"},Tt={class:"col-12 col-md-5"},Ut={class:"coupon input-group mb-3 input-group-sm"},jt={class:"input-group-append"},Rt={key:3,class:"container mt-10 mb-10"},Et={class:"row"},Ft={class:"d-flex justify-content-between"};function Ot(e,n,c,A,h,i){const v=g("VueLoading"),f=g("UserCartStepComponent"),_=g("RouterLink"),P=g("router-link"),S=g("DelModal");return s(),d(y,null,[m(v,{active:e.isLoading,loader:"bars",color:"#034D83"},null,8,["active"]),e.cartsLength>0?(s(),D(f,{key:0})):u("",!0),e.cartsLength==0?(s(),d("div",et,[t("div",ot,[st,t("div",dt,[t("h2",nt,[l(" 購物車是空的 "),at,l("請至 "),m(_,{class:"text-light fw-bold",to:"/products"},{default:b(()=>[l("清晨甜點")]),_:1}),l(" 選購 ")]),t("div",lt,[t("button",rt,[m(_,{class:"text-light",to:"/"},{default:b(()=>[l("返回首頁")]),_:1})]),t("button",ct,[m(_,{class:"text-dark",to:"/products"},{default:b(()=>[l("繼續購物")]),_:1})])])])])])):u("",!0),e.cartsLength>0?(s(),d("div",it,[t("div",ut,[e.cartsLength>0?(s(),d("a",{key:0,class:"border-bottom border-danger text-danger",type:"button",onClick:n[0]||(n[0]=o=>i.openAllDelProductModal(e.cartData))},[pt,l("清空所有商品")])):u("",!0)]),t("table",ht,[_t,t("tbody",null,[e.cartData.carts?(s(!0),d(y,{key:0},C(e.cartData.carts,o=>(s(),d("tr",{key:o.id},[t("td",mt,[t("a",{href:"#",onClick:x(a=>i.getProduct(o.product.id),["prevent"])},[t("img",{src:o.product.imageUrl,alt:"",class:"object-fit d-none d-md-block rounded-4",style:{width:"100px",height:"100px"}},null,8,bt)],8,gt)]),t("td",null,[t("a",{href:"#",class:"text-dark d-block",onClick:x(a=>i.getProduct(o.product.id),["prevent"])},p(o.product.title),9,vt)]),t("td",null,[t("div",ft,[w(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>o.qty=a,onChange:a=>e.updateCartItem(o)},[o.qty<=20?(s(),d(y,{key:0},C(20,a=>t("option",{value:a,key:a+"1234578"},p(a),9,kt)),64)):(s(!0),d(y,{key:1},C(o.qty,a=>(s(),d("option",{value:a,key:a+"1234578"},p(a),9,Ct))),128))],40,yt),[[j,o.qty]])])]),t("td",xt,p(e.toThousands(o.total)),1),t("td",Pt,[t("a",{href:"",onClick:x(a=>i.openDelProductModal(o),["prevent"])},Mt,8,Dt)])]))),128)):u("",!0)]),t("tfoot",null,[t("tr",null,[Bt,t("td",It,p(e.toThousands(e.cartData.total)),1),Lt]),t("tr",null,[Vt,t("td",At,p(e.toThousands(e.cartData.final_total)),1),St])])]),t("div",$t,[t("div",Tt,[t("div",Ut,[w(t("input",{type:"text",class:"form-control border-0 border-bottom","onUpdate:modelValue":n[1]||(n[1]=o=>h.coupon_code=o),placeholder:"請輸入優惠碼"},null,512),[[T,h.coupon_code]]),t("div",jt,[t("button",{class:U(["btn btn-primary rounded-0 border rounded-4",{disabled:h.coupon_code===""}]),type:"button",onClick:n[2]||(n[2]=(...o)=>i.addCouponCode&&i.addCouponCode(...o))}," 套用優惠碼 ",2)])])])])])):u("",!0),e.cartsLength>0?(s(),d("div",Rt,[t("div",Et,[t("div",Ft,[m(P,{to:"/products",class:"btn btn-outline-primary px-5 rounded-4"},{default:b(()=>[l("繼續選購")]),_:1}),e.cartsLength>0?(s(),D(P,{key:0,to:"/checkout",class:"btn btn-danger px-5 text-white rounded-4"},{default:b(()=>[l("下一步 ")]),_:1})):u("",!0)])])])):u("",!0),m(S,{product:h.tempProduct,cartData:h.tempCart,ref:"delModal",id:"delModal",onDelProduct:e.deleteItem},null,8,["product","cartData","onDelProduct"])],64)}const Ht=V(tt,[["render",Ot],["__scopeId","data-v-d4416bfd"]]);export{Ht as default};
