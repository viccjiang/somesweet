import{c as f}from"./UserCartStore-d28ea0d4.js";import{m as B,a as I,_ as $,o as d,b as l,d as t,f as n,t as p,r as v,K as k,h as r,e as m,w as g,F as x,E as P,G as w,H as L,D as U,g as y,J as V,p as j,i as R}from"./index-24ffc3d2.js";import{M as E}from"./modal-f9f7e3e5.js";import{U as T}from"./UserCartStepComponent-b4332377.js";import"./component-functions-9ec3c15a.js";import"./focustrap-acce5f34.js";const F={props:["product"],data(){return{modal:""}},methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()},...B(f,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","createOrder","getOrders","setModal"])},computed:{...I(f,["cartData","cartsLength"])},mounted(){this.setModal(new E(this.$refs.delmodal))}},O={id:"delProductModal",ref:"delmodal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},J={class:"modal-dialog"},N={class:"modal-content border-0"},W=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},G={class:"text-danger"},z={class:"modal-footer"},H=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Z(e,s,h,S,_,i){var b,u;return d(),l("div",O,[t("div",J,[t("div",N,[W,t("div",q,[n(" 是否刪除 "),t("strong",G,p((u=(b=h.product)==null?void 0:b.product)==null?void 0:u.title),1),n(" 商品 ")]),t("div",z,[H,t("button",{type:"button",class:"btn btn-danger text-white",onClick:s[0]||(s[0]=C=>e.deleteItem(h.product.id))}," 確認刪除 ")])])])],512)}const X=$(F,[["render",Z]]);const{VITE_APP_URL:M,VITE_APP_PATH:D}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"jiangs2023",BASE_URL:"/somesweet/",MODE:"production",DEV:!1,PROD:!0},Q={data(){return{products:[],tempProduct:{},coupon_code:"",id:""}},components:{UserCartStepComponent:T,DelModal:X},methods:{getProducts(){this.$http.get(`${M}api/${D}/products/all`).then(e=>{console.log("產品列表:",e.data.products),this.products=e.data.products})},getProduct(e){this.$router.push(`/product/${e}`)},openDelProductModal(e){this.tempProduct={...e},console.log(this.tempProduct),this.modal.show()},addCouponCode(){const e=`${M}api/${D}/coupon`,s={code:this.coupon_code};this.$http.post(e,{data:s}).then(h=>{console.log(h),this.coupon_code="",this.getCarts()})},...B(f,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","createOrder","getOrders","setModal"])},computed:{...I(f,["cartData","cartsLength","modal"])},mounted(){this.getProducts(),this.getCarts()}},c=e=>(j("data-v-ade2d956"),e=e(),R(),e),Y={key:1,class:"text-center"},K={class:"card border-0 rounded-0 bg-dark text-white"},tt=c(()=>t("img",{style:{height:"70vh","background-image":"url(https://storage.googleapis.com/vue-course-api.appspot.com/jiangs2023/1678158943058.jpg?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=Jn44%2B%2Bkd2gsFMtS91bnOaxSgmiZ1%2Byv%2B9wCGscJsTeCPU%2FnJc9ZMY5OM9AHec%2FYg0WQ%2BBMf2MqVBex%2Buondfr5cs8qgrLhRaqjzancMVsdSQh7%2Bt%2Bvve3ZpNoGtFIw29HggFVxqpBmJfWJU43sheDg966D5usj5PlkswQ7xutpIJwBZSAu4tuYZ%2BhVszThrE3rXRR9BRRfXvRxgiJpPlrlg3XxAbSE%2BvNgwq4iRl11eaE5fXuWGI8nRu4ORW%2FhG1SBtgGsYb0TAJ4jFPxNlDKjmI%2FBal2WrWD32jtOjvsSUbtxatHQ5OKx0vos6oW%2BIonUawlg6B%2FsNcChWBXVxDZw%3D%3D)","background-size":"cover","background-position":"center bottom","object-fit":"cover","background-attachment":"fixed","background-blend-mode":"multiply","background-color":"rgba(0, 0, 0, 0.6)"}},null,-1)),et={class:"card-img-overlay d-flex flex-column justify-content-center align-item-center"},ot={class:"card-title text-center"},st=c(()=>t("br",null,null,-1)),dt={class:"d-flex align-items-center justify-content-center mt-5"},nt={type:"button",class:"btn btn-outline-secondary me-5"},at={type:"button",class:"btn btn-light"},lt={key:2,class:"container"},ct={class:"text-end mb-7"},rt=c(()=>t("i",{class:"bi bi-trash3 text-danger me-2"},null,-1)),it={class:"table align-middle table-hover"},ut=c(()=>t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"100px"}},"數量"),t("th",{class:"text-end"},"單價"),t("th")])],-1)),pt={style:{width:"15%"}},ht=["onClick"],_t=["src"],mt=["onClick"],gt={class:"input-group input-group-sm"},bt=["onUpdate:modelValue","onChange"],vt=["value"],ft={class:"text-end"},Ct={class:"text-end"},xt=["onClick"],yt=c(()=>t("i",{class:"bi bi-trash3 text-danger"},null,-1)),kt=[yt],Pt=c(()=>t("td",{colspan:"3",class:"text-end"},"總計",-1)),wt={class:"text-end"},Mt=c(()=>t("td",null,null,-1)),Dt=c(()=>t("td",{colspan:"3",class:"text-end text-success"},"折扣完總金額",-1)),Bt={class:"text-end text-success"},It=c(()=>t("td",null,null,-1)),$t={class:"row justify-content-end"},St={class:"col-12 col-md-5"},At={class:"coupon input-group mb-3 input-group-sm"},Lt={class:"input-group-append"},Ut={key:3,class:"container mt-10 mb-10"},Vt={class:"row"},jt={class:"d-flex justify-content-between"};function Rt(e,s,h,S,_,i){const b=v("UserCartStepComponent"),u=v("RouterLink"),C=v("router-link"),A=v("DelModal");return d(),l(x,null,[e.cartsLength>0?(d(),k(b,{key:0})):r("",!0),e.cartsLength==0?(d(),l("div",Y,[t("div",K,[tt,t("div",et,[t("h2",ot,[n(" 購物車是空的 "),st,n("請至 "),m(u,{class:"text-light fw-bold",to:"/products"},{default:g(()=>[n("清晨甜點")]),_:1}),n(" 選購 ")]),t("div",dt,[t("button",nt,[m(u,{class:"text-light",to:"/"},{default:g(()=>[n("返回首頁")]),_:1})]),t("button",at,[m(u,{class:"text-dark",to:"/products"},{default:g(()=>[n("繼續購物")]),_:1})])])])])])):r("",!0),e.cartsLength>0?(d(),l("div",lt,[t("div",ct,[e.cartsLength>0?(d(),l("a",{key:0,class:"border-bottom border-danger text-danger",type:"button",onClick:s[0]||(s[0]=(...o)=>e.deleteAllItem&&e.deleteAllItem(...o))},[rt,n("清空所有商品")])):r("",!0)]),t("table",it,[ut,t("tbody",null,[e.cartData.carts?(d(!0),l(x,{key:0},P(e.cartData.carts,o=>(d(),l("tr",{key:o.id},[t("td",pt,[t("a",{href:"#",onClick:y(a=>i.getProduct(o.product.id),["prevent"])},[t("img",{src:o.product.imageUrl,alt:"",class:"object-fit d-none d-md-block rounded-4",style:{width:"100px",height:"100px"}},null,8,_t)],8,ht)]),t("td",null,[t("a",{href:"#",class:"text-dark d-block",onClick:y(a=>i.getProduct(o.product.id),["prevent"])},p(o.product.title),9,mt)]),t("td",null,[t("div",gt,[w(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>o.qty=a,onChange:a=>e.updateCartItem(o)},[(d(),l(x,null,P(20,a=>t("option",{value:a,key:a+"1234578"},p(a),9,vt)),64))],40,bt),[[V,o.qty]])])]),t("td",ft,p(o.total),1),t("td",Ct,[t("a",{href:"",onClick:y(a=>i.openDelProductModal(o),["prevent"])},kt,8,xt)])]))),128)):r("",!0)]),t("tfoot",null,[t("tr",null,[Pt,t("td",wt,p(e.cartData.total),1),Mt]),t("tr",null,[Dt,t("td",Bt,p(e.cartData.final_total),1),It])])]),t("div",$t,[t("div",St,[t("div",At,[w(t("input",{type:"text",class:"form-control border-0 border-bottom","onUpdate:modelValue":s[1]||(s[1]=o=>_.coupon_code=o),placeholder:"請輸入優惠碼"},null,512),[[L,_.coupon_code]]),t("div",Lt,[t("button",{class:U(["btn btn-primary rounded-0 border",{disabled:_.coupon_code===""}]),type:"button",onClick:s[2]||(s[2]=(...o)=>i.addCouponCode&&i.addCouponCode(...o))}," 套用優惠碼 ",2)])])])])])):r("",!0),e.cartsLength>0?(d(),l("div",Ut,[t("div",Vt,[t("div",jt,[m(C,{to:"/products",class:"btn btn-outline-primary px-5"},{default:g(()=>[n("繼續選購")]),_:1}),e.cartsLength>0?(d(),k(C,{key:0,to:"/checkout",class:"btn btn-danger px-5 text-white"},{default:g(()=>[n("下一步 ")]),_:1})):r("",!0)])])])):r("",!0),m(A,{product:_.tempProduct,ref:"delModal",id:"delModal",onDelProduct:e.deleteItem},null,8,["product","onDelProduct"])],64)}const Wt=$(Q,[["render",Rt],["__scopeId","data-v-ade2d956"]]);export{Wt as default};
