import{c as b}from"./UserCartStore-f1e720b9.js";import{m as B,a as I,_ as $,o as n,b as l,d as t,f as s,t as i,r as g,K as x,h as r,e as _,w as m,F as f,E as P,G as w,H as L,D as U,g as C,J as V,p as j,i as R}from"./index-9de5b8df.js";import{M as E}from"./modal-c7d3bce7.js";import{U as T}from"./UserCartStepComponent-1855703f.js";import"./component-functions-56125361.js";import"./focustrap-143653cc.js";const F={props:["product"],data(){return{modal:""}},methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()},...B(b,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","createOrder","getOrders","setModal"])},computed:{...I(b,["cartData","cartsLength"])},mounted(){this.setModal(new E(this.$refs.delmodal))}},O={id:"delProductModal",ref:"delmodal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},J={class:"modal-dialog"},N={class:"modal-content border-0"},W=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},G={class:"text-danger"},z={class:"modal-footer"},H=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Z(e,d,u,S,h,p){return n(),l("div",O,[t("div",J,[t("div",N,[W,s(" "+i(u.product.id)+" ",1),t("div",q,[s(" 是否刪除 "),t("strong",G,i(u.product.title),1),s(" 商品(刪除後將無法恢復)。 ")]),t("div",z,[H,t("button",{type:"button",class:"btn btn-danger",onClick:d[0]||(d[0]=y=>e.deleteItem(u.product.id))}," 確認刪除 ")])])])],512)}const X=$(F,[["render",Z]]);const{VITE_APP_URL:M,VITE_APP_PATH:D}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"jiangs2023",BASE_URL:"/somesweet/",MODE:"production",DEV:!1,PROD:!0},Q={data(){return{products:[],tempProduct:{},coupon_code:""}},components:{UserCartStepComponent:T,DelModal:X},methods:{getProducts(){this.$http.get(`${M}api/${D}/products/all`).then(e=>{console.log("產品列表:",e.data.products),this.products=e.data.products})},getProduct(e){this.$router.push(`/product/${e}`)},openDelProductModal(e){this.tempProduct={...e},console.log(this.tempProduct),this.modal.show()},addCouponCode(){const e=`${M}api/${D}/coupon`,d={code:this.coupon_code};this.$http.post(e,{data:d}).then(u=>{console.log(u),this.coupon_code="",this.getCarts()})},...B(b,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","createOrder","getOrders","setModal"])},computed:{...I(b,["cartData","cartsLength","modal"])},mounted(){this.getProducts(),this.getCarts()}},c=e=>(j("data-v-4b51666e"),e=e(),R(),e),Y={key:1,class:"text-center"},K={class:"card border-0 rounded-0 bg-dark text-white"},tt=c(()=>t("img",{style:{height:"70vh","background-image":"url(https://storage.googleapis.com/vue-course-api.appspot.com/jiangs2023/1678158943058.jpg?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=Jn44%2B%2Bkd2gsFMtS91bnOaxSgmiZ1%2Byv%2B9wCGscJsTeCPU%2FnJc9ZMY5OM9AHec%2FYg0WQ%2BBMf2MqVBex%2Buondfr5cs8qgrLhRaqjzancMVsdSQh7%2Bt%2Bvve3ZpNoGtFIw29HggFVxqpBmJfWJU43sheDg966D5usj5PlkswQ7xutpIJwBZSAu4tuYZ%2BhVszThrE3rXRR9BRRfXvRxgiJpPlrlg3XxAbSE%2BvNgwq4iRl11eaE5fXuWGI8nRu4ORW%2FhG1SBtgGsYb0TAJ4jFPxNlDKjmI%2FBal2WrWD32jtOjvsSUbtxatHQ5OKx0vos6oW%2BIonUawlg6B%2FsNcChWBXVxDZw%3D%3D)","background-size":"cover","background-position":"center bottom","object-fit":"cover","background-attachment":"fixed","background-blend-mode":"multiply","background-color":"rgba(0, 0, 0, 0.6)"}},null,-1)),et={class:"card-img-overlay d-flex flex-column justify-content-center align-item-center"},ot={class:"card-title text-center"},st=c(()=>t("br",null,null,-1)),dt={class:"d-flex align-items-center justify-content-center mt-5"},nt={type:"button",class:"btn btn-outline-secondary me-5"},at={type:"button",class:"btn btn-light"},lt={key:2,class:"container"},ct={class:"text-end mb-7"},rt=c(()=>t("i",{class:"bi bi-trash3 text-danger me-2"},null,-1)),it={class:"table align-middle table-hover"},ut=c(()=>t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"100px"}},"數量"),t("th",{class:"text-end"},"單價"),t("th")])],-1)),pt={style:{width:"15%"}},ht=["onClick"],_t=["src"],mt=["onClick"],gt={class:"input-group input-group-sm"},bt=["onUpdate:modelValue","onChange"],vt=["value"],ft={class:"text-end"},Ct={class:"text-end"},yt=["onClick"],kt=c(()=>t("i",{class:"bi bi-trash3 text-danger"},null,-1)),xt=[kt],Pt=c(()=>t("td",{colspan:"3",class:"text-end"},"總計",-1)),wt={class:"text-end"},Mt=c(()=>t("td",null,null,-1)),Dt=c(()=>t("td",{colspan:"3",class:"text-end text-success"},"折扣完總金額",-1)),Bt={class:"text-end text-success"},It=c(()=>t("td",null,null,-1)),$t={class:"row justify-content-end"},St={class:"col-12 col-md-5"},At={class:"coupon input-group mb-3 input-group-sm"},Lt={class:"input-group-append"},Ut={key:3,class:"container mt-10 mb-10"},Vt={class:"row"},jt={class:"d-flex justify-content-between"};function Rt(e,d,u,S,h,p){const y=g("UserCartStepComponent"),v=g("RouterLink"),k=g("router-link"),A=g("DelModal");return n(),l(f,null,[e.cartsLength>0?(n(),x(y,{key:0})):r("",!0),e.cartsLength==0?(n(),l("div",Y,[t("div",K,[tt,t("div",et,[t("h2",ot,[s(" 購物車是空的 "),st,s("請至 "),_(v,{class:"text-light fw-bold",to:"/products"},{default:m(()=>[s("清晨甜點")]),_:1}),s(" 選購 ")]),t("div",dt,[t("button",nt,[_(v,{class:"text-light",to:"/"},{default:m(()=>[s("返回首頁")]),_:1})]),t("button",at,[_(v,{class:"text-dark",to:"/products"},{default:m(()=>[s("繼續購物")]),_:1})])])])])])):r("",!0),e.cartsLength>0?(n(),l("div",lt,[t("div",ct,[e.cartsLength>0?(n(),l("a",{key:0,class:"border-bottom border-danger text-danger",type:"button",onClick:d[0]||(d[0]=(...o)=>e.deleteAllItem&&e.deleteAllItem(...o))},[rt,s("清空所有商品")])):r("",!0)]),t("table",it,[ut,t("tbody",null,[e.cartData.carts?(n(!0),l(f,{key:0},P(e.cartData.carts,o=>(n(),l("tr",{key:o.id},[t("td",pt,[t("a",{href:"#",onClick:C(a=>p.getProduct(o.product.id),["prevent"])},[t("img",{src:o.product.imageUrl,alt:"",class:"object-fit d-none d-md-block rounded-4",style:{width:"100px",height:"100px"}},null,8,_t)],8,ht)]),t("td",null,[t("a",{href:"#",class:"text-dark d-block",onClick:C(a=>p.getProduct(o.product.id),["prevent"])},i(o.product.title),9,mt)]),t("td",null,[t("div",gt,[w(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>o.qty=a,onChange:a=>e.updateCartItem(o)},[(n(),l(f,null,P(20,a=>t("option",{value:a,key:a+"1234578"},i(a),9,vt)),64))],40,bt),[[V,o.qty]])])]),t("td",ft,i(o.total),1),t("td",Ct,[t("a",{href:"",onClick:C(a=>p.openDelProductModal(o.product),["prevent"])},xt,8,yt)])]))),128)):r("",!0)]),t("tfoot",null,[t("tr",null,[Pt,t("td",wt,i(e.cartData.total),1),Mt]),t("tr",null,[Dt,t("td",Bt,i(e.cartData.final_total),1),It])])]),t("div",$t,[t("div",St,[t("div",At,[w(t("input",{type:"text",class:"form-control border-0 border-bottom","onUpdate:modelValue":d[1]||(d[1]=o=>h.coupon_code=o),placeholder:"請輸入優惠碼"},null,512),[[L,h.coupon_code]]),t("div",Lt,[t("button",{class:U(["btn btn-primary rounded-0 border",{disabled:h.coupon_code===""}]),type:"button",onClick:d[2]||(d[2]=(...o)=>p.addCouponCode&&p.addCouponCode(...o))}," 套用優惠碼 ",2)])])])])])):r("",!0),e.cartsLength>0?(n(),l("div",Ut,[t("div",Vt,[t("div",jt,[_(k,{to:"/products",class:"btn btn-outline-primary px-5"},{default:m(()=>[s("繼續選購")]),_:1}),e.cartsLength>0?(n(),x(k,{key:0,to:"/checkout",class:"btn btn-danger px-5 text-white"},{default:m(()=>[s("下一步 ")]),_:1})):r("",!0)])])])):r("",!0),_(A,{product:h.tempProduct,ref:"delModal",id:"delModal",onDelProduct:e.deleteItem},null,8,["product","onDelProduct"])],64)}const Wt=$(Q,[["render",Rt],["__scopeId","data-v-4b51666e"]]);export{Wt as default};
