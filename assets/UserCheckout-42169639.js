import{_ as U,V as k,m as A,a as D,r as i,o as p,b as h,e as t,d as e,F as b,i as P,t as r,w as _,f as v,u,j as E,v as L}from"./index-aac9fba2.js";import{c as g}from"./UserCartStore-78d69a48.js";import{U as S}from"./UserCartStepComponent-aad0848d.js";const{VITE_APP_URL:V,VITE_APP_PATH:w}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"jiangs2023",BASE_URL:"/somesweet/",MODE:"production",DEV:!1,PROD:!0},j={data(){return{form:{user:{name:"",email:"",tel:"",address:"",shipping:""},message:""},orders:[]}},components:{UserCartStepComponent:S,VueLoading:k},methods:{getOrders(){const o=`${V}api/${w}/orders`;this.$http.get(o).then(s=>{console.log(s.data.orders),this.orders=s.data.orders})},createOrder(){const o=`${V}api/${w}/order`,s=this.form;this.$http.post(o,{data:s}).then(n=>{console.log(n),n.data.success&&(this.$router.push(`/order_payment/${n.data.orderId}`),this.$refs.form.resetForm()),this.getCarts()}).catch(n=>{alert(n.data.message)})},...A(g,["addToCart","getCarts","updateCartItem","deleteItem","deleteAllItem","toThousands"])},computed:{...D(g,["cartData","cartsLength","isLoading"])},mounted(){this.getCarts()}},I={class:"bg-light pt-5 pb-7 mt-5"},N={class:"container"},F={class:"row justify-content-center flex-column flex-md-row"},q={class:"col-md-5 sticky-md-top position-md-sticky h-50"},O={class:"border rounded-4 p-4 mb-4"},$=e("h4",{class:"mb-4"},"訂單明細",-1),B=["src"],M={class:"w-100"},R={class:"d-flex justify-content-between fw-bold"},H={class:"mb-0"},z={class:"mb-0"},G={class:"d-flex justify-content-between"},J={class:"text-muted mb-0"},K={class:"mb-0"},Q={class:"table mt-4 border-top border-bottom text-muted"},W=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"原價",-1),X={class:"text-end border-0 px-0 pt-4"},Y=e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"優惠價",-1),Z={class:"text-end border-0 px-0 pt-0 pb-4"},ee={class:"d-flex justify-content-between mt-4"},se=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),te={class:"mb-0 h4 fw-bold"},oe={class:"p-0"},le={class:""},ae={class:"d-none d-md-grid"},de={class:"col-md-7"},re={class:"row justify-content-center p-4"},ne=e("h4",{class:"mb-4 text-center text-md-start"},"填寫訂購資訊",-1),ie={class:"mb-3"},ce=e("label",{for:"email",class:"form-label"},"Email",-1),me={class:"mb-3"},ue=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),_e={class:"mb-3"},pe=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),he={class:"mb-3"},fe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),be={class:"mb-3"},ve=e("label",{for:"address",class:"form-label"},"交易方式",-1),ge=e("option",{value:""},"請選擇交易方式",-1),Ve=e("option",{value:"ATM"},"ATM",-1),we=e("option",{value:"匯款"},"匯款",-1),xe=e("option",{value:"信用卡"},"信用卡",-1),Te={class:"mb-5"},ye=e("label",{for:"message",class:"form-label"},"留言",-1),Ce=e("div",{class:"text-end d-grid"},[e("button",{type:"submit",class:"btn btn-danger mb-5 text-white"},"送出訂單")],-1);function Ue(o,s,n,ke,l,x){const T=i("VueLoading"),y=i("UserCartStepComponent"),f=i("router-link"),c=i("FieldView"),m=i("error-message"),C=i("FormView");return p(),h(b,null,[t(T,{active:o.isLoading,loader:"bars",color:"#034D83"},null,8,["active"]),t(y),e("div",null,[e("div",I,[e("div",N,[e("div",F,[e("div",q,[e("div",O,[$,(p(!0),h(b,null,P(o.cartData.carts,a=>(p(),h("div",{class:"d-flex",key:a.id},[e("img",{src:a.product.imageUrl,alt:"",class:"me-2 my-1 w-50",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,B),e("div",M,[e("div",R,[e("p",H,r(a.product.title),1),e("p",z,"x "+r(a.qty),1)]),e("div",G,[e("p",J,[e("small",null,"NT$"+r(o.toThousands(a.product.price)),1)]),e("p",K,"NT$"+r(o.toThousands(a.final_total)),1)])])]))),128)),e("table",Q,[e("tbody",null,[e("tr",null,[W,e("td",X," NT$"+r(o.toThousands(o.cartData.total)),1)]),e("tr",null,[Y,e("td",Z," NT$"+r(o.toThousands(o.cartData.final_total)),1)])])]),e("div",ee,[se,e("p",te,"NT$"+r(o.toThousands(o.cartData.final_total)),1)])]),e("div",oe,[e("div",le,[e("div",ae,[t(f,{to:"/cart",class:"btn btn-outline-secondary px-5 mb-5"},{default:_(()=>[v("回上一頁")]),_:1}),t(f,{to:"/products",class:"btn btn-outline-primary px-5"},{default:_(()=>[v("繼續選購")]),_:1})])])])]),e("div",de,[e("div",re,[ne,t(C,{ref:"form",class:"border rounded-4 p-10",onSubmit:x.createOrder},{default:_(({errors:a})=>[e("div",ie,[ce,t(c,{id:"email",name:"email",label:"信箱",type:"email",class:u(["form-control rounded-3",{"is-invalid":a.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=d=>l.form.user.email=d)},null,8,["class","modelValue"]),t(m,{name:"email",class:"invalid-feedback"})]),e("div",me,[ue,t(c,{id:"name",name:"name",label:"姓名",type:"text",class:u(["form-control rounded-3",{"is-invalid":a.name}]),rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=d=>l.form.user.name=d),placeholder:"請輸入姓名"},null,8,["class","modelValue"]),t(m,{name:"name",class:"invalid-feedback"})]),e("div",_e,[pe,t(c,{id:"tel",name:"tel",label:"電話",type:"text",class:u(["form-control rounded-3",{"is-invalid":a.tel}]),rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=d=>l.form.user.tel=d),placeholder:"請輸入電話"},null,8,["class","modelValue"]),t(m,{name:"tel",class:"invalid-feedback"})]),e("div",he,[fe,t(c,{id:"address",name:"address",label:"地址",type:"text",class:u(["form-control rounded-3",{"is-invalid":a.address}]),rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=d=>l.form.user.address=d),placeholder:"請輸入地址"},null,8,["class","modelValue"]),t(m,{name:"address",class:"invalid-feedback"})]),e("div",be,[ve,t(c,{id:"name",name:"trade",label:"交易方式",class:u(["form-select rounded-3",{"is-invalid":a.trade}]),placeholder:"請輸入交易方式",rules:"required",modelValue:l.form.user.shipping,"onUpdate:modelValue":s[4]||(s[4]=d=>l.form.user.shipping=d),as:"select"},{default:_(()=>[ge,Ve,we,xe]),_:2},1032,["class","modelValue"]),t(m,{name:"trade",class:"invalid-feedback"})]),e("div",Te,[ye,E(e("textarea",{id:"message",class:"form-control rounded-4",cols:"30",rows:"10","onUpdate:modelValue":s[5]||(s[5]=d=>l.form.user.message=d)},null,512),[[L,l.form.user.message]])]),Ce]),_:1},8,["onSubmit"])])])])])])])],64)}const Ee=U(j,[["render",Ue]]);export{Ee as default};
